{
  "version": 3,
  "sources": ["../src/index.js", "../src/cdn.js"],
  "sourcesContent": ["export default function (Alpine) {\n  // The magic\n  Alpine.magic('sail', () => (link) => _D?.sail(link))\n\n  // The directive\n  Alpine.directive('sail', (el, { modifiers, expression }, { effect, evaluateLater, cleanup }) => {\n    const link = { path: null, state: null, replace: false, active: null }\n    const evaluator = evaluateLater(expression)\n    const active = []\n    const anchor = {}\n\n    // Listen...\n    effect(() => {\n      evaluator((evaluated) => {\n        // CSS classes\n        active.splice(0, active.length)\n        active.push(...modifiers)\n\n        if (typeof evaluated === 'string' || typeof evaluated === 'number') {\n          // The number zero should be\n          // trapped here, but why would\n          // anyone use 0 in an ID at all?\n          link.path = evaluated.toString()\n        } else if (!evaluated) {\n          return unlink()\n        } else if (Array.isArray(evaluated)) {\n          link.path = evaluated.join('/')\n        } else if (typeof evaluated === 'object') {\n          // Links can provided as objects, like:\n          // { path: '/sunrise', active: 'shadow' }\n          link.path = Array.isArray(evaluated.path)\n            ? evaluated.path.join('/')\n            : evaluated.path.toString()\n          link.state = evaluated.state ?? null\n          link.replace = !!evaluated.replace\n\n          if (evaluated.active) {\n            active.push(...evaluated.active.split(' ').filter(Boolean))\n          }\n        }\n\n        // No path,\n        // No sailing.\n        if (!link.path) {\n          return unlink()\n        }\n\n        // Reflect URL changes on\n        // active CSS classes and\n        // a[href] attributes.\n        if (active.length || el.tagName === 'A') {\n          refresh()\n          addEventListener('underscored:sailed', refresh)\n        }\n\n        // Trigger on...\n        el.addEventListener('click', click)\n      })\n    })\n\n    // Hard cleanup\n    cleanup(() => unlink())\n\n    /**\n     * Prevent the default click action and try navigating with `_D.sail()`.\n     * If the target element is an anchor with an external link, do nothing.\n     *\n     * @param {Event} event\n     */\n    function click(event) {\n      if (_D && !anchor.external) {\n        event.preventDefault()\n        _D.sail(link)\n      }\n    }\n\n    /**\n     * Toggle active CSS classes when the current link is active.\n     *\n     * If the target element is an anchor, generate a URL from the current path\n     * with `_D.url` and set it as its `href` attribute. Also, set the default\n     * values of `target` and `rel` to `_blank` and `noopener noreferrer`.\n     */\n    function refresh() {\n      // Sink...\n      if (!_D) {\n        return\n      }\n\n      // Create URL from path\n      const url = _D.url(link.path)\n\n      // Handle active CSS classes\n      if (url?.origin === location.origin && url?.pathname === location.pathname) {\n        active.forEach((className) => el.classList.add(className))\n      } else {\n        active.forEach((className) => el.classList.remove(className))\n      }\n\n      // Handle anchors\n      if (el.tagName === 'A') {\n        if (!anchor.initial) {\n          // Some attributes\n          // are restored\n          // upon cleaning.\n          anchor.initial = {\n            href: el.getAttribute('href'),\n            target: el.getAttribute('target'),\n            rel: el.getAttribute('rel'),\n          }\n        }\n\n        anchor.url = url?.href ?? ''\n        anchor.external = !anchor.url.startsWith(location.origin + _D.base())\n        el.setAttribute('href', anchor.url)\n\n        if (anchor.external) {\n          if (typeof anchor.initial.target !== 'string') {\n            el.setAttribute('target', '_blank')\n          }\n\n          if (typeof anchor.initial.rel !== 'string') {\n            el.setAttribute('rel', 'noopener noreferrer')\n          }\n        } else {\n          restoreAnchorAttributes(['target', 'rel'])\n        }\n      }\n    }\n\n    /**\n     * Restore initial anchor attributes.\n     *\n     * @param {string[]} atts\n     */\n    function restoreAnchorAttributes(atts = ['href', 'target', 'rel']) {\n      if (anchor.initial) {\n        atts.forEach((att) => {\n          if (typeof anchor.initial[att] === 'string') {\n            el.setAttribute(att, anchor.initial[att])\n          } else {\n            el.removeAttribute(att, anchor.initial[att])\n          }\n        })\n      }\n    }\n\n    /**\n     * Soft cleanup.\n     */\n    function unlink() {\n      el.removeEventListener('click', click)\n      removeEventListener('underscored:sailed', refresh)\n      active.forEach((className) => el.classList.remove(className))\n      restoreAnchorAttributes()\n    }\n  })\n}\n", "import xSail from './'\n\ndocument.addEventListener('alpine:init', () => window.Alpine.plugin(xSail))\n"],
  "mappings": "MAAe,WAAU,EAAQ,CAE/B,EAAO,MAAM,OAAQ,IAAM,AAAC,GAAS,IAAI,KAAK,IAG9C,EAAO,UAAU,OAAQ,CAAC,EAAI,CAAE,YAAW,cAAc,CAAE,SAAQ,gBAAe,aAAc,CAC9F,GAAM,GAAO,CAAE,KAAM,KAAM,MAAO,KAAM,QAAS,GAAO,OAAQ,MAC1D,EAAY,EAAc,GAC1B,EAAS,GACT,EAAS,GAGf,EAAO,IAAM,CACX,EAAU,AAAC,GAAc,CAKvB,GAHA,EAAO,OAAO,EAAG,EAAO,QACxB,EAAO,KAAK,GAAG,GAEX,MAAO,IAAc,UAAY,MAAO,IAAc,SAIxD,EAAK,KAAO,EAAU,mBACZ,EAEL,AAAI,MAAM,QAAQ,GACvB,EAAK,KAAO,EAAU,KAAK,KAClB,MAAO,IAAc,UAG9B,GAAK,KAAO,MAAM,QAAQ,EAAU,MAChC,EAAU,KAAK,KAAK,KACpB,EAAU,KAAK,WACnB,EAAK,MAAQ,EAAU,OAAS,KAChC,EAAK,QAAU,CAAC,CAAC,EAAU,QAEvB,EAAU,QACZ,EAAO,KAAK,GAAG,EAAU,OAAO,MAAM,KAAK,OAAO,eAbpD,OAAO,KAmBT,GAAI,CAAC,EAAK,KACR,MAAO,KAMT,AAAI,GAAO,QAAU,EAAG,UAAY,MAClC,KACA,iBAAiB,qBAAsB,IAIzC,EAAG,iBAAiB,QAAS,OAKjC,EAAQ,IAAM,KAQd,WAAe,EAAO,CACpB,AAAI,IAAM,CAAC,EAAO,UAChB,GAAM,iBACN,GAAG,KAAK,IAWZ,YAAmB,CAEjB,GAAI,CAAC,GACH,OAIF,GAAM,GAAM,GAAG,IAAI,EAAK,MAGxB,AAAI,GAAK,SAAW,SAAS,QAAU,GAAK,WAAa,SAAS,SAChE,EAAO,QAAQ,AAAC,GAAc,EAAG,UAAU,IAAI,IAE/C,EAAO,QAAQ,AAAC,GAAc,EAAG,UAAU,OAAO,IAIhD,EAAG,UAAY,KACZ,GAAO,SAIV,GAAO,QAAU,CACf,KAAM,EAAG,aAAa,QACtB,OAAQ,EAAG,aAAa,UACxB,IAAK,EAAG,aAAa,SAIzB,EAAO,IAAM,GAAK,MAAQ,GAC1B,EAAO,SAAW,CAAC,EAAO,IAAI,WAAW,SAAS,OAAS,GAAG,QAC9D,EAAG,aAAa,OAAQ,EAAO,KAE/B,AAAI,EAAO,SACL,OAAO,GAAO,QAAQ,QAAW,UACnC,EAAG,aAAa,SAAU,UAGxB,MAAO,GAAO,QAAQ,KAAQ,UAChC,EAAG,aAAa,MAAO,wBAGzB,EAAwB,CAAC,SAAU,SAUzC,WAAiC,EAAO,CAAC,OAAQ,SAAU,OAAQ,CACjE,AAAI,EAAO,SACT,EAAK,QAAQ,AAAC,GAAQ,CACpB,AAAI,MAAO,GAAO,QAAQ,IAAS,SACjC,EAAG,aAAa,EAAK,EAAO,QAAQ,IAEpC,EAAG,gBAAgB,EAAK,EAAO,QAAQ,MAS/C,YAAkB,CAChB,EAAG,oBAAoB,QAAS,GAChC,oBAAoB,qBAAsB,GAC1C,EAAO,QAAQ,AAAC,GAAc,EAAG,UAAU,OAAO,IAClD,OCxJN,SAAS,iBAAiB,cAAe,IAAM,OAAO,OAAO,OAAO",
  "names": []
}
