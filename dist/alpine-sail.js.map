{
  "version": 3,
  "sources": ["../src/index.js", "../builds/browser.js"],
  "sourcesContent": ["export default function (Alpine) {\n  // The magic\n  Alpine.magic('sail', () => (link) => _D?.sail(link))\n\n  // The directive\n  Alpine.directive('sail', (el, { modifiers, expression }, { effect, evaluateLater, cleanup }) => {\n    const link = { path: null, state: null, replace: false, active: null }\n    const evaluator = evaluateLater(expression)\n    const active = []\n    const anchor = {}\n\n    // Listen...\n    effect(() => {\n      evaluator((evaluated) => {\n        // CSS classes\n        active.splice(0, active.length)\n        active.push(...modifiers)\n\n        if (typeof evaluated === 'string' || typeof evaluated === 'number') {\n          // The number zero should be\n          // trapped here, but why would\n          // anyone use 0 in an ID at all?\n          link.path = evaluated.toString()\n        } else if (!evaluated) {\n          return unlink()\n        } else if (Array.isArray(evaluated)) {\n          link.path = evaluated.join('/')\n        } else if (typeof evaluated === 'object') {\n          // Links can provided as objects, like:\n          // { path: '/sunrise', active: 'shadow' }\n          link.path = Array.isArray(evaluated.path)\n            ? evaluated.path.join('/')\n            : evaluated.path.toString()\n          link.state = evaluated.state ?? null\n          link.replace = !!evaluated.replace\n\n          if (evaluated.active) {\n            active.push(...evaluated.active.split(' ').filter(Boolean))\n          }\n        }\n\n        // No path,\n        // No sailing.\n        if (!link.path) {\n          return unlink()\n        }\n\n        // Reflect URL changes on\n        // active CSS classes and\n        // a[href] attributes.\n        if (active.length || el.tagName === 'A') {\n          refresh()\n          addEventListener('underscored:sailed', refresh)\n        }\n\n        // Trigger on...\n        el.addEventListener('click', click)\n      })\n    })\n\n    // Hard cleanup\n    cleanup(() => unlink())\n\n    /**\n     * Prevent the default click action and try navigating with `_D.sail()`.\n     * If the target element is an anchor with an external link, do nothing.\n     *\n     * @param {Event} event\n     */\n    function click(event) {\n      if (_D && !anchor.external) {\n        event.preventDefault()\n        _D.sail(link)\n      }\n    }\n\n    /**\n     * Toggle active CSS classes when the current link is active.\n     *\n     * If the target element is an anchor, generate a URL from the current path\n     * with `_D.url` and set it as its `href` attribute. Also, set the default\n     * values of `target` and `rel` to `_blank` and `noopener noreferrer`.\n     */\n    function refresh() {\n      // Sink...\n      if (!_D) {\n        return\n      }\n\n      // Create URL from path\n      const url = _D.url(link.path)\n\n      // Handle active CSS classes\n      if (url?.origin === location.origin && url?.pathname === location.pathname) {\n        active.forEach((className) => el.classList.add(className))\n      } else {\n        active.forEach((className) => el.classList.remove(className))\n      }\n\n      // Handle anchors\n      if (el.tagName === 'A') {\n        if (!anchor.initial) {\n          // Some attributes\n          // are restored\n          // upon cleaning.\n          anchor.initial = {\n            href: el.getAttribute('href'),\n            target: el.getAttribute('target'),\n            rel: el.getAttribute('rel'),\n          }\n        }\n\n        anchor.url = url?.href ?? ''\n        anchor.external = !anchor.url.startsWith(location.origin + _D.base())\n        el.setAttribute('href', anchor.url)\n\n        if (anchor.external) {\n          if (typeof anchor.initial.target !== 'string') {\n            el.setAttribute('target', '_blank')\n          }\n\n          if (typeof anchor.initial.rel !== 'string') {\n            el.setAttribute('rel', 'noopener noreferrer')\n          }\n        } else {\n          restoreAnchorAttributes(['target', 'rel'])\n        }\n      }\n    }\n\n    /**\n     * Restore initial anchor attributes.\n     *\n     * @param {string[]} atts\n     */\n    function restoreAnchorAttributes(atts = ['href', 'target', 'rel']) {\n      if (anchor.initial) {\n        atts.forEach((att) => {\n          if (typeof anchor.initial[att] === 'string') {\n            el.setAttribute(att, anchor.initial[att])\n          } else {\n            el.removeAttribute(att, anchor.initial[att])\n          }\n        })\n      }\n    }\n\n    /**\n     * Soft cleanup.\n     */\n    function unlink() {\n      el.removeEventListener('click', click)\n      removeEventListener('underscored:sailed', refresh)\n      active.forEach((className) => el.classList.remove(className))\n      restoreAnchorAttributes()\n    }\n  })\n}\n", "import sail from '../src/index.js'\n\ndocument.addEventListener('alpine:init', () => window.Alpine.plugin(sail))\n"],
  "mappings": ";;AAAe,uBAAU,QAAQ;AAE/B,WAAO,MAAM,QAAQ,MAAM,CAAC,SAAS,IAAI,KAAK,IAAI,CAAC;AAGnD,WAAO,UAAU,QAAQ,CAAC,IAAI,EAAE,WAAW,cAAc,EAAE,QAAQ,eAAe,cAAc;AAC9F,YAAM,OAAO,EAAE,MAAM,MAAM,OAAO,MAAM,SAAS,OAAO,QAAQ,KAAK;AACrE,YAAM,YAAY,cAAc,UAAU;AAC1C,YAAM,SAAS,CAAC;AAChB,YAAM,SAAS,CAAC;AAGhB,aAAO,MAAM;AACX,kBAAU,CAAC,cAAc;AAEvB,iBAAO,OAAO,GAAG,OAAO,MAAM;AAC9B,iBAAO,KAAK,GAAG,SAAS;AAExB,cAAI,OAAO,cAAc,YAAY,OAAO,cAAc,UAAU;AAIlE,iBAAK,OAAO,UAAU,SAAS;AAAA,UACjC,WAAW,CAAC,WAAW;AACrB,mBAAO,OAAO;AAAA,UAChB,WAAW,MAAM,QAAQ,SAAS,GAAG;AACnC,iBAAK,OAAO,UAAU,KAAK,GAAG;AAAA,UAChC,WAAW,OAAO,cAAc,UAAU;AAGxC,iBAAK,OAAO,MAAM,QAAQ,UAAU,IAAI,IACpC,UAAU,KAAK,KAAK,GAAG,IACvB,UAAU,KAAK,SAAS;AAC5B,iBAAK,QAAQ,UAAU,SAAS;AAChC,iBAAK,UAAU,CAAC,CAAC,UAAU;AAE3B,gBAAI,UAAU,QAAQ;AACpB,qBAAO,KAAK,GAAG,UAAU,OAAO,MAAM,GAAG,EAAE,OAAO,OAAO,CAAC;AAAA,YAC5D;AAAA,UACF;AAIA,cAAI,CAAC,KAAK,MAAM;AACd,mBAAO,OAAO;AAAA,UAChB;AAKA,cAAI,OAAO,UAAU,GAAG,YAAY,KAAK;AACvC,oBAAQ;AACR,6BAAiB,sBAAsB,OAAO;AAAA,UAChD;AAGA,aAAG,iBAAiB,SAAS,KAAK;AAAA,QACpC,CAAC;AAAA,MACH,CAAC;AAGD,cAAQ,MAAM,OAAO,CAAC;AAQtB,qBAAe,OAAO;AACpB,YAAI,MAAM,CAAC,OAAO,UAAU;AAC1B,gBAAM,eAAe;AACrB,aAAG,KAAK,IAAI;AAAA,QACd;AAAA,MACF;AASA,yBAAmB;AAEjB,YAAI,CAAC,IAAI;AACP;AAAA,QACF;AAGA,cAAM,MAAM,GAAG,IAAI,KAAK,IAAI;AAG5B,YAAI,KAAK,WAAW,SAAS,UAAU,KAAK,aAAa,SAAS,UAAU;AAC1E,iBAAO,QAAQ,CAAC,cAAc,GAAG,UAAU,IAAI,SAAS,CAAC;AAAA,QAC3D,OAAO;AACL,iBAAO,QAAQ,CAAC,cAAc,GAAG,UAAU,OAAO,SAAS,CAAC;AAAA,QAC9D;AAGA,YAAI,GAAG,YAAY,KAAK;AACtB,cAAI,CAAC,OAAO,SAAS;AAInB,mBAAO,UAAU;AAAA,cACf,MAAM,GAAG,aAAa,MAAM;AAAA,cAC5B,QAAQ,GAAG,aAAa,QAAQ;AAAA,cAChC,KAAK,GAAG,aAAa,KAAK;AAAA,YAC5B;AAAA,UACF;AAEA,iBAAO,MAAM,KAAK,QAAQ;AAC1B,iBAAO,WAAW,CAAC,OAAO,IAAI,WAAW,SAAS,SAAS,GAAG,KAAK,CAAC;AACpE,aAAG,aAAa,QAAQ,OAAO,GAAG;AAElC,cAAI,OAAO,UAAU;AACnB,gBAAI,OAAO,OAAO,QAAQ,WAAW,UAAU;AAC7C,iBAAG,aAAa,UAAU,QAAQ;AAAA,YACpC;AAEA,gBAAI,OAAO,OAAO,QAAQ,QAAQ,UAAU;AAC1C,iBAAG,aAAa,OAAO,qBAAqB;AAAA,YAC9C;AAAA,UACF,OAAO;AACL,oCAAwB,CAAC,UAAU,KAAK,CAAC;AAAA,UAC3C;AAAA,QACF;AAAA,MACF;AAOA,uCAAiC,OAAO,CAAC,QAAQ,UAAU,KAAK,GAAG;AACjE,YAAI,OAAO,SAAS;AAClB,eAAK,QAAQ,CAAC,QAAQ;AACpB,gBAAI,OAAO,OAAO,QAAQ,SAAS,UAAU;AAC3C,iBAAG,aAAa,KAAK,OAAO,QAAQ,IAAI;AAAA,YAC1C,OAAO;AACL,iBAAG,gBAAgB,KAAK,OAAO,QAAQ,IAAI;AAAA,YAC7C;AAAA,UACF,CAAC;AAAA,QACH;AAAA,MACF;AAKA,wBAAkB;AAChB,WAAG,oBAAoB,SAAS,KAAK;AACrC,4BAAoB,sBAAsB,OAAO;AACjD,eAAO,QAAQ,CAAC,cAAc,GAAG,UAAU,OAAO,SAAS,CAAC;AAC5D,gCAAwB;AAAA,MAC1B;AAAA,IACF,CAAC;AAAA,EACH;;;AC3JA,WAAS,iBAAiB,eAAe,MAAM,OAAO,OAAO,OAAO,WAAI,CAAC;",
  "names": []
}
